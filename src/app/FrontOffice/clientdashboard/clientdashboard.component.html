<div class="dashboard-container">
  <!-- Header/Navbar -->
  <header class="dashboard-header">
    <div class="header-content">
      <!-- Logo on the left -->
      <div class="logo-section">
        <img src="images/tt-logo.png" alt="Tunisie Telecom" class="logo">
      </div>

      <!-- Navigation buttons in center -->
      <nav class="nav-section">
        <button class="nav-button" (click)="openReclamationModal()">
          <span class="nav-icon">ğŸ“</span>
          RÃ©clamation
        </button>
        <button class="nav-button" (click)="openRenseignement()">
          <span class="nav-icon">ğŸ’¬</span>
          Renseignement
        </button>
      </nav>

      <!-- User menu on the right -->
      <div class="user-section">
        <div class="user-menu" (click)="toggleDropdown()" *ngIf="currentUser">
          <img 
            [src]="currentUser.photoUser || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiM2Yzc1N2QiLz4KPHN2ZyB4PSI4IiB5PSI4IiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSI+CjxwYXRoIGQ9Ik0xMiAxMkM5LjUgMTIgNy41IDEwIDcuNSA3LjVTOS41IDMgMTIgM3MyIDQgNC41IDcuNVM5LjUgMTIgMTIgMTJaTTEyIDEzLjVjLTMgMC04IDEuNS04IDQuNXYyaDEydi0yYzAtM3MtNS00LjUtOC00LjVaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4KPC9zdmc+'"
            [alt]="currentUser.nomUser + ' ' + currentUser.prenomUser" 
            class="user-avatar"
            (error)="onImageError($event)"
          >
          <span class="user-name">{{ currentUser.nomUser + ' ' + currentUser.prenomUser }}</span>
          <span class="dropdown-arrow" [class.rotated]="isDropdownOpen">â–¼</span>
          
          <div class="dropdown-menu" [class.show]="isDropdownOpen">
            <div class="dropdown-header">
              <img 
                [src]="currentUser.photoUser || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiM2Yzc1N2QiLz4KPHN2ZyB4PSI4IiB5PSI4IiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSI+CjxwYXRoIGQ9Ik0xMiAxMkM5LjUgMTIgNy41IDEwIDcuNSA3LjVTOS41IDMgMTIgM3MyIDQgNC41IDcuNVM5LjUgMTIgMTIgMTJaTTEyIDEzLjVjLTMgMC04IDEuNS04IDQuNXYyaDEydi0yYzAtM3M1LTQuNS04LTQuNVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo8L3N2Zz4='"
                [alt]="currentUser.nomUser + ' ' + currentUser.prenomUser" 
                class="dropdown-avatar"
                (error)="onImageError($event)"
              >
              <div class="dropdown-user-info">
                <div class="dropdown-name">{{ currentUser.nomUser + ' ' + currentUser.prenomUser }}</div>
                <div class="dropdown-email">{{ currentUser.emailUser }}</div>
                <div class="dropdown-info">Ligne: {{ currentUser.numeroLigne }}</div>
              </div>
            </div>
            <div class="dropdown-divider"></div>
            <button class="dropdown-item" (click)="navigateToAccount()">
              <span class="dropdown-icon">ğŸ‘¤</span>
              Mon compte
            </button>
            <button class="dropdown-item" (click)="openChangePasswordModal()">
              <span class="dropdown-icon">ğŸ”‘</span>
              Changer password
            </button>
            <button class="dropdown-item" (click)="openPhotoModal()">
              <span class="dropdown-icon">ğŸ“·</span>
              Modifier photo
            </button>
            <button class="dropdown-item logout" (click)="logout()">
              <span class="dropdown-icon">ğŸšª</span>
              DÃ©connexion
            </button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="dashboard-main">
    <!-- Welcome Section -->
    <section class="welcome-section">
      <div class="welcome-content">
        <h1 class="welcome-title">Bienvenue, {{ currentUser.nomUser }} {{ currentUser.prenomUser }} !</h1>
        <p class="welcome-subtitle">GÃ©rez vos services Tunisie Telecom en toute simplicitÃ©</p>
      </div>
      <div class="welcome-stats">
        <div class="stat-card reclamations-card blinking" (click)="openReclamationsListModal()" style="cursor: pointer;">
          <div class="stat-icon">ğŸ“‹</div>
          <div class="stat-info">
            <div class="stat-number">{{reclamationsList.length}} RÃ©clamation(s)</div>
            <div class="stat-label">Afficher RÃ©clamations</div>
          </div>
        </div>
        <!-- <div class="stat-card">
          <div class="stat-icon">ğŸ’³ğŸ“Š</div>
          <div class="stat-info">
            <div class="stat-number">125 DT</div>
            <div class="stat-label">Facture du mois</div>
          </div>
        </div>-->
        <div class="stat-card renseignements-card blinking" (click)="openRenseignementsListModal()" style="cursor: pointer;">
          <div class="stat-icon">ğŸ“±</div>
          <div class="stat-info">
            <div class="stat-number">{{renseignementsList.length}} Renseignement(s)</div>
            <div class="stat-label">Afficher Renseignement</div>
          </div>
        </div> 
      </div>
    </section>

    <!-- Services Section -->
    <section class="services-section">
      <h2 class="section-title">Nos Services</h2>
      <div class="services-grid">
        <div class="service-card" *ngFor="let service of services">
          <div class="service-header">
            <div class="service-icon">{{ service.icon }}</div>
            <h3 class="service-title">{{ service.title }}</h3>
          </div>
          <p class="service-description">{{ service.description }}</p>
          <ul class="service-features">
            <li *ngFor="let feature of service.features">{{ feature }}</li>
          </ul>
          <button class="service-button">En savoir plus</button>
        </div>
      </div>
    </section>

    <!-- News Section -->
    <section class="news-section">
      <h2 class="section-title">ActualitÃ©s</h2>
      <div class="news-grid">
        <article class="news-card" *ngFor="let article of news">
          <div class="news-header">
            <h3 class="news-title">{{ article.title }}</h3>
            <span class="news-date">{{ article.date }}</span>
          </div>
          <p class="news-content">{{ article.content }}</p>
          <button class="news-button">Lire la suite</button>
        </article>
      </div>
    </section>

    <!-- About Section -->
    <section class="about-section">
      <div class="about-content">
        <h2 class="section-title">Ã€ propos de Tunisie Telecom</h2>
        <div class="about-grid">
          <div class="about-text">
            <p>
              Tunisie Telecom est l'opÃ©rateur historique et leader des tÃ©lÃ©communications en Tunisie. 
              Depuis plus de 20 ans, nous accompagnons les particuliers et les entreprises dans leur 
              transformation digitale.
            </p>
            <p>
              Avec un rÃ©seau de plus de 1000 points de vente et un service client disponible 24h/24, 
              nous nous engageons Ã  offrir la meilleure qualitÃ© de service Ã  nos clients.
            </p>
            <div class="about-stats">
              <div class="about-stat">
                <div class="about-stat-number">7M+</div>
                <div class="about-stat-label">Clients</div>
              </div>
              <div class="about-stat">
                <div class="about-stat-number">1000+</div>
                <div class="about-stat-label">Points de vente</div>
              </div>
              <div class="about-stat">
                <div class="about-stat-number">24/7</div>
                <div class="about-stat-label">Support client</div>
              </div>
            </div>
          </div>
          <div class="about-image">
            <div class="about-card">
              <h3>Notre Mission</h3>
              <p>Connecter la Tunisie au monde digital avec des solutions innovantes et accessibles.</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="dashboard-footer">
    <div class="footer-content">
      <p>&copy; 2025 Tunisie Telecom. Tous droits rÃ©servÃ©s.</p>
      <div class="footer-links">
        <a href="#" class="footer-link">Conditions d'utilisation</a>
        <a href="#" class="footer-link">Politique de confidentialitÃ©</a>
        <a href="#" class="footer-link">Contact</a>
      </div>
    </div>
  </footer>
</div>

<!-- Modal pour changer le mot de passe -->
<div class="modal-overlay" [class.show]="isChangePasswordModalOpen" (click)="closeChangePasswordModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">Changer le mot de passe</h3>
      <button class="modal-close" (click)="closeChangePasswordModal()">Ã—</button>
    </div>
    
    <form [formGroup]="changePasswordForm" (ngSubmit)="onChangePassword()" class="modal-form">
      <div class="form-group">
        <label for="oldPassword">Ancien mot de passe</label>
        <div class="password-input-container">
          <input 
            id="oldPassword"
            formControlName="oldPassword"
            [type]="showOldPassword ? 'text' : 'password'"
            class="form-input"
            placeholder="Entrez votre ancien mot de passe"
            [class.error]="changePasswordForm.get('oldPassword')?.invalid && changePasswordForm.get('oldPassword')?.touched"
          >
          <button 
            type="button" 
            class="password-toggle"
            (click)="toggleOldPasswordVisibility()"
            tabindex="-1"
          >
            {{ showOldPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
        <div class="error-message" *ngIf="changePasswordForm.get('oldPassword')?.invalid && changePasswordForm.get('oldPassword')?.touched">
          L'ancien mot de passe est requis
        </div>
      </div>

      <div class="form-group">
        <label for="newPassword">Nouveau mot de passe</label>
        <div class="password-input-container">
          <input 
            id="newPassword"
            formControlName="newPassword"
            [type]="showNewPassword ? 'text' : 'password'"
            class="form-input"
            placeholder="Entrez votre nouveau mot de passe"
            [class.error]="changePasswordForm.get('newPassword')?.invalid && changePasswordForm.get('newPassword')?.touched"
          >
          <button 
            type="button" 
            class="password-toggle"
            (click)="toggleNewPasswordVisibility()"
            tabindex="-1"
          >
            {{ showNewPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
        <div class="error-message" *ngIf="changePasswordForm.get('newPassword')?.invalid && changePasswordForm.get('newPassword')?.touched">
          Le nouveau mot de passe est requis (minimum 6 caractÃ¨res)
        </div>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirmer le nouveau mot de passe</label>
        <div class="password-input-container">
          <input 
            id="confirmPassword"
            formControlName="confirmPassword"
            [type]="showConfirmPassword ? 'text' : 'password'"
            class="form-input"
            placeholder="Confirmez votre nouveau mot de passe"
            [class.error]="changePasswordForm.get('confirmPassword')?.invalid && changePasswordForm.get('confirmPassword')?.touched"
          >
          <button 
            type="button" 
            class="password-toggle"
            (click)="toggleConfirmPasswordVisibility()"
            tabindex="-1"
          >
            {{ showConfirmPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
        <div class="error-message" *ngIf="changePasswordForm.get('confirmPassword')?.invalid && changePasswordForm.get('confirmPassword')?.touched">
          <span *ngIf="changePasswordForm.get('confirmPassword')?.errors?.['required']">La confirmation du mot de passe est requise</span>
          <span *ngIf="changePasswordForm.get('confirmPassword')?.errors?.['passwordMismatch']">Les mots de passe ne correspondent pas</span>
        </div>
      </div>

      <div class="modal-actions">
        <button type="button" class="btn-cancel" (click)="closeChangePasswordModal()">
          Annuler
        </button>
        <button 
          type="submit" 
          class="btn-submit" 
          [disabled]="changePasswordForm.invalid || isChangingPassword"
        >
          <span *ngIf="isChangingPassword">ğŸ”„ Changement...</span>
          <span *ngIf="!isChangingPassword">Changer le mot de passe</span>
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal pour les informations utilisateur -->
<div class="modal-overlay" [class.show]="isUserInfoModalOpen" (click)="closeUserInfoModal()">
  <div class="modal-content user-info-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">Mon Compte</h3>
      <button class="modal-close" (click)="closeUserInfoModal()">Ã—</button>
    </div>
    
    <div class="user-info-content">
      <!-- Photo de profil -->
      <div class="profile-photo-section">
        <div class="profile-photo-container" (click)="onProfilePhotoClick()" [class.updating]="isUpdatingPhoto">
          <img 
            [src]="currentUser?.photoUser || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjUwIiBmaWxsPSIjNmM3NTdkIi8+CjxzdmcgeD0iMjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSI+CjxwYXRoIGQ9Ik0xMiAxMkM5LjUgMTIgNy41IDEwIDcuNSA3LjVTOS41IDMgMTIgM3MyIDQgNC41IDcuNVM5LjUgMTIgMTIgMTJaTTEyIDEzLjVjLTMgMC04IDEuNS04IDQuNXYyaDEydi0yYzAtM3M1LTQuNS04LTQuNVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo8L3N2Zz4='"
            [alt]="currentUser?.nomUser + ' ' + currentUser?.prenomUser" 
            class="profile-photo"
            [class.updating]="isUpdatingPhoto"
            (error)="onImageError($event)"
          >
          
          <!-- Overlay pour indiquer que la photo est cliquable -->
          <div class="photo-overlay" [class.show]="!isUpdatingPhoto">
            <div class="photo-edit-icon">ğŸ“·</div>
            <span class="photo-edit-text">Changer la photo</span>
          </div>
          
          <!-- Indicateur de chargement -->
          <div class="photo-loading" [class.show]="isUpdatingPhoto">
            <div class="loading-spinner"></div>
            <span class="loading-text">Mise Ã  jour...</span>
          </div>
        </div>
        <h4 class="profile-name">{{ currentUser?.prenomUser }} {{ currentUser?.nomUser }}</h4>
        <!-- <h4 class="profile-name">{{ currentUser?.prenomUser }} {{ currentUser?.nomUser }}</h4> -->
        <p class="profile-role">{{ currentUser?.role === 'ROLE_CLIENT' ? 'Client' : currentUser?.role }}</p>
      </div>

      <!-- Informations personnelles -->
      <div class="info-section">
        <h5 class="section-title">
          <span class="section-icon">ğŸ‘¤</span>
          Informations personnelles
        </h5>
        <div class="info-grid">
          <div class="info-item">
            <label class="info-label">PrÃ©nom</label>
            <span class="info-value">{{ currentUser?.prenomUser || 'Non renseignÃ©' }}</span>
          </div>
          <div class="info-item">
            <label class="info-label">Nom</label>
            <span class="info-value">{{ currentUser?.nomUser || 'Non renseignÃ©' }}</span>
          </div>
          <div class="info-item">
            <label class="info-label">Email</label>
            <span class="info-value">{{ currentUser?.emailUser || 'Non renseignÃ©' }}</span>
          </div>
          <div class="info-item">
            <label class="info-label">RÃ´le</label>
            <span class="info-value role-badge" [class]="currentUser?.role?.toLowerCase()">
              {{ currentUser?.role === 'ROLE_CLIENT' ? 'Client' : currentUser?.role === 'ROLE_ADMIN' ? 'Administrateur' : currentUser?.role }}
            </span>
          </div>
        </div>
      </div>

      <!-- Informations de service -->
      <div class="info-section">
        <h5 class="section-title">
          <span class="section-icon">ğŸ“</span>
          Informations de service
        </h5>
        <div class="info-grid">
          <div class="info-item">
            <label class="info-label">NumÃ©ro de ligne</label>
            <span class="info-value">{{ currentUser?.numeroLigne || 'Non renseignÃ©' }}</span>
          </div>
          <div class="info-item">
            <label class="info-label">Ã‰tat du compte</label>
            <span class="info-value status-badge" [class]="currentUser?.etatCompte?.toLowerCase()">
              {{ currentUser?.etatCompte || 'Non renseignÃ©' }}
            </span>
          </div>
          <div class="info-item full-width">
            <label class="info-label">carte d'identitÃ©</label>
            <div class="info-value document-container" *ngIf="currentUser?.documentContrat; else noDocument">
              <!-- Si c'est une image -->
              <div *ngIf="isImageFile(currentUser.documentContrat)" class="document-image-container">
                <img 
                  [src]="currentUser.documentContrat" 
                  alt="Document de contrat" 
                  class="document-image"
                  (click)="openDocumentViewer(currentUser.documentContrat, 'image')"
                  (error)="onDocumentError($event)"
                >
                <button class="view-document-btn" (click)="openDocumentViewer(currentUser.documentContrat, 'image')">
                  <span class="btn-icon">ğŸ”</span>
                  Voir l'image
                </button>
              </div>
              
              <!-- Si c'est un PDF -->
              <div *ngIf="isPdfFile(currentUser.documentContrat)" class="document-pdf-container">
                <div class="pdf-icon">ğŸ“„</div>
                <div class="pdf-info">
                  <span class="pdf-name">Carte d'identitÃ©.pdf</span>
                  <span class="pdf-size">Carte PDF</span>
                </div>
                <button class="view-document-btn" (click)="openDocumentViewer(currentUser.documentContrat, 'pdf')">
                  <span class="btn-icon">ğŸ“–</span>
                  Ouvrir PDF
                </button>
              </div>
              
              <!-- Si c'est un autre type de fichier -->
              <div *ngIf="!isImageFile(currentUser.documentContrat) && !isPdfFile(currentUser.documentContrat)" class="document-other-container">
                <div class="file-icon">ğŸ“</div>
                <div class="file-info">
                  <span class="file-name">{{ getFileName(currentUser.documentContrat) }}</span>
                  <span class="file-type">Document</span>
                </div>
                <a [href]="currentUser.documentContrat" target="_blank" class="view-document-btn">
                  <span class="btn-icon">â¬‡ï¸</span>
                  TÃ©lÃ©charger
                </a>
              </div>
            </div>
            <ng-template #noDocument>
              <span class="info-value no-document">Aucun document</span>
            </ng-template>
          </div>
        </div>
      </div>

      <!-- Informations du compte -->
      <div class="info-section">
        <h5 class="section-title">
          <span class="section-icon">ğŸ†”</span>
          Informations du compte
        </h5>
        <div class="info-grid">
          <div class="info-item">
            <label class="info-label">Identifiant Utilisateur</label>
            <span class="info-value">{{ currentUser?.emailUser || 'Non renseignÃ©' }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-primary" (click)="closeUserInfoModal()">
        Fermer
      </button>
    </div>
  </div>
</div>



<!-- Modal pour modification de photo -->
  <div class="modal-overlay" [class.show]="isPhotoModalOpen" (click)="closePhotoModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">Modifier la photo de profil</h2>
        <button class="modal-close" (click)="closePhotoModal()">Ã—</button>
      </div>
      
      <div class="modal-body">
        <div class="photo-upload-section">
          <div class="current-photo" *ngIf="currentUser">
            <img 
              [src]="currentUser.photoUser || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjUwIiBmaWxsPSIjMjhhNzQ1Ii8+CjxzdmcgeD0iMjAiIHk9IjIwIiB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSI+CjxwYXRoIGQ9Ik0xMiAxMkM5LjUgMTIgNy41IDEwIDcuNSA3LjVTOS41IDMgMTIgM3MyIDQgNC41IDcuNVM5LjUgMTIgMTIgMTJaTTEyIDEzLjVjLTMgMC04IDEuNS04IDQuNXYyaDEydi0yYzAtM3MtNS00LjUtOC00LjVaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4KPC9zdmc+'"
              [alt]="currentUser.nomUser + ' ' + currentUser.prenomUser" 
              class="current-photo-img"
              (error)="onImageError($event)"
            >
          </div>
          
          <div class="upload-instructions">
            <h4>Instructions :</h4>
            <ul>
              <li>Formats acceptÃ©s : JPG, PNG, GIF</li>
              <li>Taille maximale : 5 MB</li>
              <li>Dimensions recommandÃ©es : 400x400 pixels</li>
            </ul>
          </div>
        </div>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closePhotoModal()">
          Annuler
        </button>
        <button type="button" class="btn btn-primary" (click)="onProfilePhotoClick()" [disabled]="isUpdatingPhoto">
          <span *ngIf="isUpdatingPhoto">ğŸ”„ Upload...</span>
          <span *ngIf="!isUpdatingPhoto">ğŸ“· SÃ©lectionner une photo</span>
        </button>
      </div>
    </div>
  </div>

<!-- Modal pour crÃ©er un renseignement -->
<div class="modal-overlay" [class.show]="isRenseignementModalOpen" (click)="closeRenseignementModal()">
  <div class="modal-content renseignement-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">ğŸ’¬ CrÃ©er un renseignement</h3>
      <div class="header-actions">
        <button class="list-renseignements-btn-header" (click)="openRenseignementsListModal(); closeRenseignementModal()">
          <span class="btn-icon">ğŸ“</span>
          Lister mes renseignements
        </button>
        <button class="modal-close" (click)="closeRenseignementModal()">Ã—</button>
      </div>
    </div>
    
    <div class="modal-body">
      <!-- Message d'information -->
      <div class="info-banner">
        <div class="info-icon">ğŸ’¡</div>
        <div class="info-content">
          <h5>Demande de renseignement</h5>
          <p>Posez vos questions concernant nos services, offres, tarifs ou toute autre demande d'information.</p>
        </div>
      </div>

      <!-- Message de limitation -->
      <div class="info-banner limitation-banner">
        <div class="info-icon">âš ï¸</div>
        <div class="info-content">
          <h5>Limitation importante</h5>
          <p>Vous ne pouvez crÃ©er que <strong>3 renseignements maximum par jour</strong> pour assurer un traitement optimal de vos demandes.</p>
        </div>
      </div>

      <form [formGroup]="renseignementForm" class="renseignement-form">
        <!-- Sujet du renseignement -->
        <div class="form-group">
          <label for="sujetRens" class="form-label">
            <span class="label-icon">ğŸ“‹</span>
            Sujet de votre demande *
          </label>
          <div class="dropdown-container">
            <select 
              id="sujetRens"
              formControlName="sujetRens"
              class="form-input"
              [class.error]="renseignementForm.get('sujetRens')?.invalid && renseignementForm.get('sujetRens')?.touched"
            >
              <option value="">SÃ©lectionnez le sujet de votre demande</option>
              <option *ngFor="let option of sujetRenseignementOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </div>
          <div class="error-message" *ngIf="renseignementForm.get('sujetRens')?.invalid && renseignementForm.get('sujetRens')?.touched">
            <span *ngIf="renseignementForm.get('sujetRens')?.errors?.['required']">Le sujet est requis</span>
          </div>
        </div>

        <!-- Description de la demande -->
        <div class="form-group">
          <label for="descriptionRens" class="form-label">
            <span class="label-icon">ğŸ’¬</span>
            Description de votre demande *
          </label>
          <textarea 
            id="descriptionRens"
            formControlName="descriptionRens"
            class="form-textarea"
            rows="5"
            placeholder="DÃ©crivez votre demande de renseignement en dÃ©tail..."
            [class.error]="renseignementForm.get('descriptionRens')?.invalid && renseignementForm.get('descriptionRens')?.touched"
          ></textarea>
          <div class="char-counter">
            {{ renseignementForm.get('descriptionRens')?.value?.length || 0 }}/500 caractÃ¨res
          </div>
          <div class="error-message" *ngIf="renseignementForm.get('descriptionRens')?.invalid && renseignementForm.get('descriptionRens')?.touched">
            <span *ngIf="renseignementForm.get('descriptionRens')?.errors?.['required']">La description est requise</span>
            <span *ngIf="renseignementForm.get('descriptionRens')?.errors?.['minlength']">La description doit contenir au moins 10 caractÃ¨res</span>
            <span *ngIf="renseignementForm.get('descriptionRens')?.errors?.['maxlength']">La description ne peut pas dÃ©passer 500 caractÃ¨res</span>
          </div>
        </div>

        <!-- Informations client (automatiques) -->
        <div class="form-group client-info">
          <h4 class="info-title">
            <span class="info-icon">ğŸ‘¤</span>
            Informations du client
          </h4>
          <div class="info-grid">
            <div class="info-item">
              <label>Nom complet</label>
              <span>{{ currentUser?.prenomUser }} {{ currentUser?.nomUser }}</span>
            </div>
            <div class="info-item">
              <label>Email</label>
              <span>{{ currentUser?.emailUser }}</span>
            </div>
            <div class="info-item">
              <label>NumÃ©ro de ligne</label>
              <span>{{ currentUser?.numeroLigne || 'Non renseignÃ©' }}</span>
            </div>
          </div>
        </div>
      </form>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="btn-cancel" (click)="closeRenseignementModal()">
        Annuler
      </button>
      <button 
        type="button" 
        class="btn-submit" 
        (click)="submitRenseignement()"
        [disabled]="renseignementForm.invalid || isSubmittingRenseignement"
      >
        <span *ngIf="isSubmittingRenseignement">ğŸ”„ Envoi...</span>
        <span *ngIf="!isSubmittingRenseignement">ğŸ’¬ Envoyer la demande</span>
      </button>
    </div>
  </div>
</div>

<!-- Modal pour crÃ©er une rÃ©clamation -->
<div class="modal-overlay" [class.show]="isReclamationModalOpen" (click)="closeReclamationModal()">
  <div class="modal-content reclamation-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">ğŸ“ CrÃ©er une rÃ©clamation</h3>
      <div class="header-actions">
        <button class="list-reclamations-btn-header" (click)="openReclamationsListModal(); closeReclamationModal()">
          <span class="btn-icon">ğŸ“‹</span>
          Lister mes rÃ©clamations
        </button>
        <button class="modal-close" (click)="closeReclamationModal()">Ã—</button>
      </div>
    </div>
    
    <div class="modal-body">
      <!-- Message d'information sur la limitation -->
      <div class="info-banner">
        <div class="info-icon">âš ï¸</div>
        <div class="info-content">
          <h5>Information importante</h5>
          <p>Vous ne pouvez crÃ©er qu'<strong>une seule rÃ©clamation par heure</strong> pour assurer un traitement optimal de votre demande.</p>
        </div>
      </div>

      <form [formGroup]="reclamationForm" class="reclamation-form">
        <!-- Type de rÃ©clamation -->
        <div class="form-group">
          <label for="typeRecl" class="form-label">
            <span class="label-icon">ğŸ·ï¸</span>
            Type de rÃ©clamation *
          </label>
          <select 
            id="typeRecl" 
            formControlName="typeRecl" 
            class="form-input"
            [class.error]="reclamationForm.get('typeRecl')?.invalid && reclamationForm.get('typeRecl')?.touched"
            (change)="onTypeReclChange($event)"
          >
            <option value="">SÃ©lectionnez un type</option>
            <option value="Mon_compte_MY_TT">Mon compte MY TT</option>
            <option value="Mon_Mobile">Mon Mobile</option>
            <option value="Internet_Mobile">Internet Mobile</option>
            <option value="Mon_Fixe">Mon Fixe</option>
            <option value="Service_e_Facture">Service e-Facture</option>
          </select>
          <div class="error-message" *ngIf="reclamationForm.get('typeRecl')?.invalid && reclamationForm.get('typeRecl')?.touched">
            Le type de rÃ©clamation est requis
          </div>
        </div>

        <!-- Sujet de la rÃ©clamation -->
        <div class="form-group" *ngIf="currentSujetReclOptions.length > 0">
          <label for="sujetRecl" class="form-label">
            <span class="label-icon">ğŸ“‹</span>
            Sujet de la rÃ©clamation *
          </label>
          <select 
            id="sujetRecl" 
            formControlName="sujetRecl" 
            class="form-input"
            [class.error]="reclamationForm.get('sujetRecl')?.invalid && reclamationForm.get('sujetRecl')?.touched"
          >
            <option value="">SÃ©lectionnez le sujet</option>
            <option *ngFor="let option of currentSujetReclOptions" [value]="option">
              {{ option }}
            </option>
          </select>
          <div class="error-message" *ngIf="reclamationForm.get('sujetRecl')?.invalid && reclamationForm.get('sujetRecl')?.touched">
            Le sujet est requis
          </div>
        </div>

        <!-- NumÃ©ro concernÃ© -->
        <div class="form-group">
          <label for="numeroConcerne" class="form-label">
            <span class="label-icon">ğŸ“</span>
            NumÃ©ro concernÃ© *
          </label>
          <input 
            id="numeroConcerne"
            formControlName="numeroConcerne"
            type="text"
            class="form-input"
            placeholder="Entrez le numÃ©ro de 8 chiffres..."
            maxlength="8"
            [class.error]="reclamationForm.get('numeroConcerne')?.invalid && reclamationForm.get('numeroConcerne')?.touched"
            (input)="limitNumeroConcerneDigits($event)"
          >
          <div class="input-hint">
            <small>Format: 8 chiffres exactement (ex: 12345678)</small>
          </div>
          <div class="error-message" *ngIf="reclamationForm.get('numeroConcerne')?.invalid && reclamationForm.get('numeroConcerne')?.touched">
            <span *ngIf="reclamationForm.get('numeroConcerne')?.errors?.['required']">Le numÃ©ro concernÃ© est requis</span>
            <span *ngIf="reclamationForm.get('numeroConcerne')?.errors?.['pattern']">Le numÃ©ro doit contenir exactement 8 chiffres</span>
          </div>
        </div>

        <!-- Description -->
        <div class="form-group">
          <label for="descriptionRecl" class="form-label">
            <span class="label-icon">ğŸ“</span>
            Description du problÃ¨me *
          </label>
          <textarea 
            id="descriptionRecl"
            formControlName="descriptionRecl"
            class="form-textarea"
            rows="4"
            placeholder="DÃ©crivez votre problÃ¨me en dÃ©tail..."
            [class.error]="reclamationForm.get('descriptionRecl')?.invalid && reclamationForm.get('descriptionRecl')?.touched"
          ></textarea>
          <div class="char-counter">
            {{ reclamationForm.get('descriptionRecl')?.value?.length || 0 }}/500 caractÃ¨res
          </div>
          <div class="error-message" *ngIf="reclamationForm.get('descriptionRecl')?.invalid && reclamationForm.get('descriptionRecl')?.touched">
            <span *ngIf="reclamationForm.get('descriptionRecl')?.errors?.['required']">La description est requise</span>
            <span *ngIf="reclamationForm.get('descriptionRecl')?.errors?.['minlength']">La description doit contenir au moins 10 caractÃ¨res</span>
            <span *ngIf="reclamationForm.get('descriptionRecl')?.errors?.['maxlength']">La description ne peut pas dÃ©passer 500 caractÃ¨res</span>
          </div>
        </div>

        <!-- Section des fichiers en ligne -->
        <div class="files-row">
          <!-- Capture d'Ã©cran -->
          <div class="form-group file-group">
            <label class="form-label">
              <span class="label-icon">ğŸ“·</span>
              Capture d'Ã©cran (optionnel)
            </label>
            <div class="file-upload-container">
              <input 
                type="file" 
                id="captureFileInput" 
                accept=".png,.jpg,.jpeg" 
                (change)="onCaptureFileSelected($event)"
                class="file-input"
                hidden
              >
              <button 
                type="button" 
                class="file-upload-btn"
                (click)="triggerCaptureUpload()"
                [disabled]="isUploadingCapture"
              >
                <span class="upload-icon">ğŸ“·</span>
                <span *ngIf="!isUploadingCapture && !selectedCaptureFile">Choisir une image</span>
                <span *ngIf="isUploadingCapture">ğŸ”„ Upload...</span>
                <span *ngIf="!isUploadingCapture && selectedCaptureFile">Changer l'image</span>
              </button>
              <div class="file-info" *ngIf="selectedCaptureFile">
                <div class="file-details">
                  <div class="file-name">{{ selectedCaptureFile.name }}</div>
                  <div class="file-size">({{ formatFileSize(selectedCaptureFile.size) }})</div>
                </div>
                <button type="button" class="remove-file-btn" (click)="removeCaptureFile()">âŒ</button>
              </div>
              <div class="upload-hint">
                <small>Formats acceptÃ©s : PNG, JPG, JPEG (max 5MB)</small>
              </div>
              
              <!-- PrÃ©visualisation de l'image en temps rÃ©el -->
              <div class="file-preview" *ngIf="selectedCaptureFile && capturePreviewUrl">
                <div class="preview-header">
                  <span class="preview-icon">ğŸ‘ï¸</span>
                  <span class="preview-title">AperÃ§u de l'image</span>
                </div>
                <div class="image-preview-container">
                  <img [src]="capturePreviewUrl" [alt]="selectedCaptureFile.name" class="preview-image">
                  <div class="image-overlay">
                    <button type="button" class="zoom-btn" (click)="openImagePreview(capturePreviewUrl, selectedCaptureFile.name)">
                      ğŸ” Agrandir
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Document -->
          <div class="form-group file-group">
            <label class="form-label">
              <span class="label-icon">ğŸ“„</span>
              Document justificatif (optionnel)
            </label>
            <div class="file-upload-container">
              <input 
                type="file" 
                id="documentFileInput" 
                accept=".pdf,.png,.jpg,.jpeg" 
                (change)="onDocumentFileSelected($event)"
                class="file-input"
                hidden
              >
              <button 
                type="button" 
                class="file-upload-btn"
                (click)="triggerDocumentUpload()"
                [disabled]="isUploadingDocument"
              >
                <span class="upload-icon">ğŸ“„</span>
                <span *ngIf="!isUploadingDocument && !selectedDocumentFile">Choisir un fichier</span>
                <span *ngIf="isUploadingDocument">ğŸ”„ Upload...</span>
                <span *ngIf="!isUploadingDocument && selectedDocumentFile">Changer le fichier</span>
              </button>
              <div class="file-info" *ngIf="selectedDocumentFile">
                <div class="file-details">
                  <div class="file-name">{{ selectedDocumentFile.name }}</div>
                  <div class="file-size">({{ formatFileSize(selectedDocumentFile.size) }})</div>
                </div>
                <button type="button" class="remove-file-btn" (click)="removeDocumentFile()">âŒ</button>
              </div>
              <div class="upload-hint">
                <small>Formats acceptÃ©s : PDF, PNG, JPG, JPEG (max 10MB)</small>
              </div>
              
              <!-- PrÃ©visualisation du document en temps rÃ©el -->
              <div class="file-preview" *ngIf="selectedDocumentFile">
                <div class="preview-header">
                  <span class="preview-icon">ğŸ‘ï¸</span>
                  <span class="preview-title">AperÃ§u du document</span>
                </div>
                
                <!-- PrÃ©visualisation pour images -->
                <div class="image-preview-container" *ngIf="isImageFile(selectedDocumentFile.type) && documentPreviewUrl">
                  <img [src]="documentPreviewUrl" [alt]="selectedDocumentFile.name" class="preview-image">
                  <div class="image-overlay">
                    <button type="button" class="zoom-btn" (click)="openImagePreview(documentPreviewUrl, selectedDocumentFile.name)">
                      ğŸ” Agrandir
                    </button>
                  </div>
                </div>
                
                <!-- PrÃ©visualisation pour PDF -->
                <div class="pdf-preview-container" *ngIf="isPdfFile(selectedDocumentFile.type)">
                  <div class="pdf-icon-large">ğŸ“„</div>
                  <div class="pdf-info">
                    <div class="pdf-name">{{ selectedDocumentFile.name }}</div>
                    <div class="pdf-size">{{ formatFileSize(selectedDocumentFile.size) }}</div>
                    <button type="button" class="view-pdf-btn" (click)="openPdfPreview(selectedDocumentFile)">
                      ğŸ“– Ouvrir le PDF
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Informations client (automatiques) -->
        <div class="form-group client-info">
          <h4 class="info-title">
            <span class="info-icon">ğŸ‘¤</span>
            Informations du client
          </h4>
          <div class="info-grid">
            <div class="info-item">
              <label>Nom complet</label>
              <span>{{ currentUser?.prenomUser }} {{ currentUser?.nomUser }}</span>
            </div>
            <div class="info-item">
              <label>Email</label>
              <span>{{ currentUser?.emailUser }}</span>
            </div>
            <div class="info-item">
              <label>NumÃ©ro de ligne</label>
              <span>{{ currentUser?.numeroLigne || 'Non renseignÃ©' }}</span>
            </div>
          </div>
        </div>
      </form>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="btn-cancel" (click)="closeReclamationModal()">
        Annuler
      </button>
      <button 
        type="button" 
        class="btn-submit" 
        (click)="submitReclamation()"
        [disabled]="reclamationForm.invalid || isSubmittingReclamation"
      >
        <span *ngIf="isSubmittingReclamation">ğŸ”„ Envoi...</span>
        <span *ngIf="!isSubmittingReclamation">ğŸ“ Envoyer la rÃ©clamation</span>
      </button>
    </div>
  </div>
</div>

<!-- Modal pour afficher la liste des rÃ©clamations -->
<div class="modal-overlay" [class.show]="isReclamationsListModalOpen" (click)="closeReclamationsListModal()">
  <div class="modal-content reclamations-list-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">ğŸ“‹ Mes RÃ©clamations</h3>
      <div class="header-actions">
        <button class="add-reclamation-btn-header" (click)="openReclamationModal(); closeReclamationsListModal()">
          <span class="btn-icon">ğŸ“</span>
          Nouvelle rÃ©clamation
        </button>
        <button class="modal-close" (click)="closeReclamationsListModal()">Ã—</button>
      </div>
    </div>
    
    <div class="modal-body">
      <!-- Filtres -->
      <div class="filters-section">
        <h4 class="filters-title">ğŸ” Filtres</h4>
        <div class="filters-row">
          <div class="filter-group">
            <label for="filterType">Type :</label>
            <select 
              id="filterType" 
              [(ngModel)]="filterTypeRecl" 
              (change)="onFilterChange()"
              class="filter-select"
            >
              <option *ngFor="let option of typeReclOptions" [value]="option.value">
                {{ option.label }}
              </option>
            </select>
          </div>
          
          <div class="filter-group">
            <label for="filterEtat">Ã‰tat :</label>
            <select 
              id="filterEtat" 
              [(ngModel)]="filterEtatRecl" 
              (change)="onFilterChange()"
              class="filter-select"
            >
              <option *ngFor="let option of etatReclOptions" [value]="option.value">
                {{ option.label }}
              </option>
            </select>
          </div>
          
          <div class="filter-group">
            <label for="filterId">ID :</label>
            <input 
              id="filterId" 
              type="text" 
              [(ngModel)]="filterIdRecl" 
              (input)="onFilterChange()"
              placeholder="Rechercher par ID..."
              class="filter-input"
            >
          </div>
          
          <div class="filter-actions">
            <button class="clear-filters-btn" (click)="clearFilters()">
              ğŸ”„ Effacer
            </button>
          </div>
        </div>
      </div>
      
      <!-- Loading -->
      <div class="loading-section" *ngIf="isLoadingReclamations">
        <div class="loading-spinner"></div>
        <p>Chargement des rÃ©clamations...</p>
      </div>
      
      <!-- Liste des rÃ©clamations -->
      <div class="reclamations-list" *ngIf="!isLoadingReclamations">
        <div class="reclamations-header">
          <h4>
            ğŸ“Š {{ filteredReclamationsList.length }} rÃ©clamation(s) 
            <span *ngIf="filteredReclamationsList.length !== reclamationsList.length">
              sur {{ reclamationsList.length }}
            </span>
          </h4>
        </div>
        
        <!-- Message si aucune rÃ©clamation -->
        <div class="no-reclamations" *ngIf="filteredReclamationsList.length === 0">
          <div class="no-data-icon">ğŸ“­</div>
          <h5>Aucune rÃ©clamation trouvÃ©e</h5>
          <p *ngIf="reclamationsList.length === 0">Vous n'avez pas encore crÃ©Ã© de rÃ©clamation.</p>
          <p *ngIf="reclamationsList.length > 0">Aucune rÃ©clamation ne correspond Ã  vos critÃ¨res de recherche.</p>
        </div>
        
        <!-- Cartes des rÃ©clamations -->
        <div class="reclamations-grid" *ngIf="filteredReclamationsList.length > 0">
          <div class="reclamation-card" *ngFor="let reclamation of filteredReclamationsList">
            <div class="reclamation-header">
              <div class="reclamation-id">
                <span class="id-label">ID:</span>
                <span class="id-value">#{{ reclamation.idRecl }}</span>
              </div>
              <div class="reclamation-status" [class]="getEtatReclClass(reclamation.etatRecl)">
                {{ getEtatReclLabel(reclamation.etatRecl) }}
              </div>
            </div>
            
            <div class="reclamation-body">
              <div class="reclamation-type">
                <span class="type-icon">ğŸ·ï¸</span>
                <span class="type-text">{{ getTypeReclLabel(reclamation.typeRecl) }}</span>
              </div>
              
              <!-- Sujet de la rÃ©clamation -->
              <div class="reclamation-sujet" *ngIf="reclamation.sujetRecl">
                <div class="sujet-item">
                  <span class="sujet-label">ğŸ“‹ Sujet:</span>
                  <span class="sujet-value">{{ reclamation.sujetRecl }}</span>
                </div>
              </div>
              
              <!-- NumÃ©ro concernÃ© -->
              <div class="reclamation-numero" *ngIf="reclamation.numeroConcerne">
                <div class="numero-item">
                  <span class="numero-label">ğŸ”¢ NumÃ©ro concernÃ©:</span>
                  <span class="numero-value">{{ reclamation.numeroConcerne }}</span>
                </div>
              </div>
              
              <div class="reclamation-description">
                <p>{{ reclamation.descriptionRecl }}</p>
              </div>
              
              <div class="reclamation-dates">
                <div class="date-item">
                  <span class="date-label">ğŸ“… CrÃ©Ã©e le:</span>
                  <span class="date-value">{{ formatDate(reclamation.dateRecl) }}</span>
                </div>
                <div class="date-item" *ngIf="reclamation.dateReponRecl">
                  <span class="date-label">âœ… RÃ©pondue le:</span>
                  <span class="date-value">{{ formatDate(reclamation.dateReponRecl) }}</span>
                </div>
              </div>
              
              <!-- RÃ©ponse si disponible -->
              <div class="reclamation-response" *ngIf="reclamation.descriptionReponRecl">
                <h6>ğŸ’¬ RÃ©ponse:</h6>
                <p>{{ reclamation.descriptionReponRecl }}</p>
              </div>
              
              <!-- Fichiers joints -->
              <div class="reclamation-files" *ngIf="reclamation.captureRecl || reclamation.documentRecl">
                <h6>ğŸ“ Fichiers joints:</h6>
                <div class="files-list">
                  <div class="file-item" *ngIf="reclamation.captureRecl">
                    <span class="file-icon">ğŸ“·</span>
                    <a [href]="reclamation.captureRecl" target="_blank" class="file-link">
                      Capture d'Ã©cran
                    </a>
                  </div>
                  <div class="file-item" *ngIf="reclamation.documentRecl">
                    <span class="file-icon">ğŸ“„</span>
                    <a [href]="reclamation.documentRecl" target="_blank" class="file-link">
                      Document
                    </a>
                  </div>
                </div>
              </div>
              
              <!-- Actions de la rÃ©clamation -->
              <div class="reclamation-actions">
                <button 
                  class="download-pdf-btn" 
                  (click)="downloadReclamationPdf(reclamation)"
                  title="TÃ©lÃ©charger le rÃ©cÃ©pissÃ© PDF"
                >
                  <span class="btn-icon">ğŸ“„</span>
                  TÃ©lÃ©charger votre reÃ§u
                </button>

                <button 
                  class="edit-btn"
                  (click)="openEditReclamationModal(reclamation)"
                  title="Modifier cette rÃ©clamation"
                  [disabled]="!canEditReclamation(reclamation)"
                  [class.disabled]="!canEditReclamation(reclamation)"
                >
                  <span class="btn-icon">âœï¸</span>
                  Modifier
                </button>

                <button 
                  class="delete-btn"
                  (click)="openDeleteConfirmation(reclamation)"
                  title="Supprimer cette rÃ©clamation"
                >
                  <span class="btn-icon">ğŸ—‘ï¸</span>
                  Supprimer
                </button>

                <!-- Bouton d'avis pour les rÃ©clamations rÃ©solues -->
                <button 
                  class="avis-btn"
                  (click)="openAvisModal(reclamation)"
                  title="Donner votre avis sur cette rÃ©clamation"
                  *ngIf="canGiveAvis(reclamation)"
                >
                  <span class="btn-icon">â­</span>
                  Donner un avis
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- <div class="modal-footer">
      <button class="btn-secondary" (click)="closeReclamationsListModal()">
        Fermer
      </button>
      <button class="btn-primary" (click)="openReclamationModal(); closeReclamationsListModal()">
        â• Nouvelle rÃ©clamation
      </button>
    </div> -->
  </div>
</div>

<!-- Modal de confirmation de suppression -->
<div class="modal-overlay" [class.show]="isDeleteConfirmationOpen" (click)="closeDeleteConfirmation()">
  <div class="modal-content delete-confirmation-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">ğŸ—‘ï¸ Confirmer la suppression</h3>
      <button class="modal-close" (click)="closeDeleteConfirmation()">Ã—</button>
    </div>
    
    <div class="modal-body">
      <div class="confirmation-content" *ngIf="reclamationToDelete">
        <div class="warning-icon">âš ï¸</div>
        <h4>ÃŠtes-vous sÃ»r de vouloir supprimer cette rÃ©clamation ?</h4>
        <div class="reclamation-details">
          <div class="detail-item">
            <span class="detail-label">ID :</span>
            <span class="detail-value">#{{ reclamationToDelete.idRecl }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Type :</span>
            <span class="detail-value">{{ getTypeReclLabel(reclamationToDelete.typeRecl) }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Ã‰tat :</span>
            <span class="detail-value status-badge" [class]="getEtatReclClass(reclamationToDelete.etatRecl)">
              {{ getEtatReclLabel(reclamationToDelete.etatRecl) }}
            </span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Date :</span>
            <span class="detail-value">{{ formatDate(reclamationToDelete.dateRecl) }}</span>
          </div>
        </div>
        <div class="warning-message">
          <p><strong>âš ï¸ Attention :</strong> Cette action est irrÃ©versible. La rÃ©clamation sera dÃ©finitivement supprimÃ©e et ne pourra pas Ãªtre rÃ©cupÃ©rÃ©e.</p>
        </div>
      </div>
    </div>
    
    <div class="modal-footer">
      <button 
        type="button" 
        class="btn-cancel" 
        (click)="closeDeleteConfirmation()"
        [disabled]="isDeletingReclamation"
      >
        Annuler
      </button>
      <button 
        type="button" 
        class="btn-delete" 
        (click)="confirmDeleteReclamation()"
        [disabled]="isDeletingReclamation"
      >
        <span *ngIf="isDeletingReclamation">ğŸ”„ Suppression...</span>
        <span *ngIf="!isDeletingReclamation">ğŸ—‘ï¸ Supprimer dÃ©finitivement</span>
      </button>
    </div>
  </div>
</div>

<!-- Modal pour modifier une rÃ©clamation -->
<div class="modal-overlay" [class.show]="isEditReclamationModalOpen" (click)="closeEditReclamationModal()">
  <div class="modal-content edit-reclamation-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">âœï¸ Modifier la rÃ©clamation</h3>
      <button class="modal-close" (click)="closeEditReclamationModal()">Ã—</button>
    </div>
    
    <div class="modal-body" *ngIf="reclamationToEdit">
      <!-- Informations de la rÃ©clamation -->
      <div class="reclamation-info-section">
        <h4 class="info-title">ğŸ“‹ RÃ©clamation #{{ reclamationToEdit.idRecl }}</h4>
        <div class="reclamation-status-info">
          <span class="status-badge" [class]="getEtatReclClass(reclamationToEdit.etatRecl)">
            {{ getEtatReclLabel(reclamationToEdit.etatRecl) }}
          </span>
          <span class="creation-date">CrÃ©Ã©e le {{ formatDate(reclamationToEdit.dateRecl) }}</span>
        </div>
      </div>

      <!-- Message d'information sur la limitation -->
      <div class="info-banner warning" *ngIf="!canEditReclamation(reclamationToEdit)">
        <div class="info-icon">âš ï¸</div>
        <div class="info-content">
          <h5>Modification non autorisÃ©e</h5>
          <p>Seules les rÃ©clamations <strong>en attente</strong> peuvent Ãªtre modifiÃ©es. Cette rÃ©clamation est actuellement <strong>{{ getEtatReclLabel(reclamationToEdit.etatRecl).toLowerCase() }}</strong>.</p>
        </div>
      </div>

      <div class="info-banner" *ngIf="canEditReclamation(reclamationToEdit)">
        <div class="info-icon">â„¹ï¸</div>
        <div class="info-content">
          <h5>Modification autorisÃ©e</h5>
          <p>Vous pouvez modifier cette rÃ©clamation car elle est encore <strong>en attente</strong> de traitement.</p>
        </div>
      </div>

      <form [formGroup]="editReclamationForm" class="edit-reclamation-form" *ngIf="canEditReclamation(reclamationToEdit)">
        <!-- Type de rÃ©clamation -->
        <div class="form-group">
          <label for="editTypeRecl" class="form-label">
            <span class="label-icon">ğŸ·ï¸</span>
            Type de rÃ©clamation *
          </label>
          <select 
            id="editTypeRecl" 
            formControlName="typeRecl" 
            class="form-input"
            [class.error]="editReclamationForm.get('typeRecl')?.invalid && editReclamationForm.get('typeRecl')?.touched"
            (change)="onEditTypeReclChange($event)"
          >
            <option value="">SÃ©lectionnez un type</option>
            <option value="Mon_compte_MY_TT">Mon compte MY TT</option>
            <option value="Mon_Mobile">Mon Mobile</option>
            <option value="Internet_Mobile">Internet Mobile</option>
            <option value="Mon_Fixe">Mon Fixe</option>
            <option value="Service_e_Facture">Service e-Facture</option>
          </select>
          <div class="error-message" *ngIf="editReclamationForm.get('typeRecl')?.invalid && editReclamationForm.get('typeRecl')?.touched">
            Le type de rÃ©clamation est requis
          </div>
        </div>

        <!-- Sujet de la rÃ©clamation -->
        <div class="form-group" *ngIf="currentSujetReclOptions.length > 0">
          <label for="editSujetRecl" class="form-label">
            <span class="label-icon">ğŸ“‹</span>
            Sujet de la rÃ©clamation *
          </label>
          <select 
            id="editSujetRecl" 
            formControlName="sujetRecl" 
            class="form-input"
            [class.error]="editReclamationForm.get('sujetRecl')?.invalid && editReclamationForm.get('sujetRecl')?.touched"
          >
            <option value="">SÃ©lectionnez le sujet</option>
            <option *ngFor="let option of currentSujetReclOptions" [value]="option">
              {{ option }}
            </option>
          </select>
          <div class="error-message" *ngIf="editReclamationForm.get('sujetRecl')?.invalid && editReclamationForm.get('sujetRecl')?.touched">
            Le sujet est requis
          </div>
        </div>

        <!-- NumÃ©ro concernÃ© -->
        <div class="form-group">
          <label for="editNumeroConcerne" class="form-label">
            <span class="label-icon">ğŸ“</span>
            NumÃ©ro concernÃ© *
          </label>
          <input 
            id="editNumeroConcerne"
            formControlName="numeroConcerne"
            type="text"
            class="form-input"
            placeholder="Entrez le numÃ©ro de 8 chiffres..."
            maxlength="8"
            [class.error]="editReclamationForm.get('numeroConcerne')?.invalid && editReclamationForm.get('numeroConcerne')?.touched"
            (input)="limitEditNumeroConcerneDigits($event)"
          >
          <div class="input-hint">
            <small>Format: 8 chiffres exactement (ex: 12345678)</small>
          </div>
          <div class="error-message" *ngIf="editReclamationForm.get('numeroConcerne')?.invalid && editReclamationForm.get('numeroConcerne')?.touched">
            <span *ngIf="editReclamationForm.get('numeroConcerne')?.errors?.['required']">Le numÃ©ro concernÃ© est requis</span>
            <span *ngIf="editReclamationForm.get('numeroConcerne')?.errors?.['pattern']">Le numÃ©ro doit contenir exactement 8 chiffres</span>
          </div>
        </div>

        <!-- Description -->
        <div class="form-group">
          <label for="editDescriptionRecl" class="form-label">
            <span class="label-icon">ğŸ“</span>
            Description du problÃ¨me *
          </label>
          <textarea 
            id="editDescriptionRecl"
            formControlName="descriptionRecl"
            class="form-textarea"
            rows="4"
            placeholder="DÃ©crivez votre problÃ¨me en dÃ©tail..."
            [class.error]="editReclamationForm.get('descriptionRecl')?.invalid && editReclamationForm.get('descriptionRecl')?.touched"
          ></textarea>
          <div class="char-counter">
            {{ editReclamationForm.get('descriptionRecl')?.value?.length || 0 }}/500 caractÃ¨res
          </div>
          <div class="error-message" *ngIf="editReclamationForm.get('descriptionRecl')?.invalid && editReclamationForm.get('descriptionRecl')?.touched">
            <span *ngIf="editReclamationForm.get('descriptionRecl')?.errors?.['required']">La description est requise</span>
            <span *ngIf="editReclamationForm.get('descriptionRecl')?.errors?.['minlength']">La description doit contenir au moins 10 caractÃ¨res</span>
            <span *ngIf="editReclamationForm.get('descriptionRecl')?.errors?.['maxlength']">La description ne peut pas dÃ©passer 500 caractÃ¨res</span>
          </div>
        </div>

        <!-- Section des fichiers existants -->
        <div class="existing-files-section" *ngIf="reclamationToEdit.captureRecl || reclamationToEdit.documentRecl">
          <h5 class="section-title">ğŸ“ Fichiers actuels</h5>
          <div class="existing-files-grid">
            <div class="existing-file-item" *ngIf="reclamationToEdit.captureRecl">
              <div class="file-icon">ğŸ“·</div>
              <div class="file-info">
                <span class="file-name">Capture d'Ã©cran actuelle</span>
                <a [href]="reclamationToEdit.captureRecl" target="_blank" class="file-link">Voir le fichier</a>
              </div>
            </div>
            <div class="existing-file-item" *ngIf="reclamationToEdit.documentRecl">
              <div class="file-icon">ğŸ“„</div>
              <div class="file-info">
                <span class="file-name">Document actuel</span>
                <a [href]="reclamationToEdit.documentRecl" target="_blank" class="file-link">Voir le fichier</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Section des nouveaux fichiers -->
        <div class="files-row">
          <!-- Nouvelle capture d'Ã©cran -->
          <div class="form-group file-group">
            <label class="form-label">
              <span class="label-icon">ğŸ“·</span>
              Nouvelle capture d'Ã©cran (optionnel)
            </label>
            <div class="file-upload-container">
              <input 
                type="file" 
                id="editCaptureFileInput" 
                accept=".png,.jpg,.jpeg" 
                (change)="onEditCaptureFileSelected($event)"
                class="file-input"
                hidden
              >
              <button 
                type="button" 
                class="file-upload-btn"
                (click)="triggerEditCaptureUpload()"
                [disabled]="isUploadingEditCapture"
              >
                <span class="upload-icon">ğŸ“·</span>
                <span *ngIf="!isUploadingEditCapture && !editSelectedCaptureFile">Choisir une nouvelle image</span>
                <span *ngIf="isUploadingEditCapture">ğŸ”„ Upload...</span>
                <span *ngIf="!isUploadingEditCapture && editSelectedCaptureFile">Changer l'image</span>
              </button>
              <div class="file-info" *ngIf="editSelectedCaptureFile">
                <div class="file-details">
                  <div class="file-name">{{ editSelectedCaptureFile.name }}</div>
                  <div class="file-size">({{ formatFileSize(editSelectedCaptureFile.size) }})</div>
                </div>
                <button type="button" class="remove-file-btn" (click)="removeEditCaptureFile()">âŒ</button>
              </div>
              <div class="upload-hint">
                <small>Formats acceptÃ©s : PNG, JPG, JPEG (max 5MB)</small>
              </div>
              
              <!-- PrÃ©visualisation de la nouvelle image -->
              <div class="file-preview" *ngIf="editSelectedCaptureFile && editCapturePreviewUrl">
                <div class="preview-header">
                  <span class="preview-icon">ğŸ‘ï¸</span>
                  <span class="preview-title">AperÃ§u de la nouvelle image</span>
                </div>
                <div class="image-preview-container">
                  <img [src]="editCapturePreviewUrl" [alt]="editSelectedCaptureFile.name" class="preview-image">
                  <div class="image-overlay">
                    <button type="button" class="zoom-btn" (click)="openImagePreview(editCapturePreviewUrl, editSelectedCaptureFile.name)">
                      ğŸ” Agrandir
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Nouveau document -->
          <div class="form-group file-group">
            <label class="form-label">
              <span class="label-icon">ğŸ“„</span>
              Nouveau document justificatif (optionnel)
            </label>
            <div class="file-upload-container">
              <input 
                type="file" 
                id="editDocumentFileInput" 
                accept=".pdf,.png,.jpg,.jpeg" 
                (change)="onEditDocumentFileSelected($event)"
                class="file-input"
                hidden
              >
              <button 
                type="button" 
                class="file-upload-btn"
                (click)="triggerEditDocumentUpload()"
                [disabled]="isUploadingEditDocument"
              >
                <span class="upload-icon">ğŸ“„</span>
                <span *ngIf="!isUploadingEditDocument && !editSelectedDocumentFile">Choisir un nouveau fichier</span>
                <span *ngIf="isUploadingEditDocument">ğŸ”„ Upload...</span>
                <span *ngIf="!isUploadingEditDocument && editSelectedDocumentFile">Changer le fichier</span>
              </button>
              <div class="file-info" *ngIf="editSelectedDocumentFile">
                <div class="file-details">
                  <div class="file-name">{{ editSelectedDocumentFile.name }}</div>
                  <div class="file-size">({{ formatFileSize(editSelectedDocumentFile.size) }})</div>
                </div>
                <button type="button" class="remove-file-btn" (click)="removeEditDocumentFile()">âŒ</button>
              </div>
              <div class="upload-hint">
                <small>Formats acceptÃ©s : PDF, PNG, JPG, JPEG (max 10MB)</small>
              </div>
              
              <!-- PrÃ©visualisation du nouveau document -->
              <div class="file-preview" *ngIf="editSelectedDocumentFile">
                <div class="preview-header">
                  <span class="preview-icon">ğŸ‘ï¸</span>
                  <span class="preview-title">AperÃ§u du nouveau document</span>
                </div>
                
                <!-- PrÃ©visualisation pour images -->
                <div class="image-preview-container" *ngIf="isImageFile(editSelectedDocumentFile.type) && editDocumentPreviewUrl">
                  <img [src]="editDocumentPreviewUrl" [alt]="editSelectedDocumentFile.name" class="preview-image">
                  <div class="image-overlay">
                    <button type="button" class="zoom-btn" (click)="openImagePreview(editDocumentPreviewUrl, editSelectedDocumentFile.name)">
                      ğŸ” Agrandir
                    </button>
                  </div>
                </div>
                
                <!-- PrÃ©visualisation pour PDF -->
                <div class="pdf-preview-container" *ngIf="isPdfFile(editSelectedDocumentFile.type)">
                  <div class="pdf-icon-large">ğŸ“„</div>
                  <div class="pdf-info">
                    <div class="pdf-name">{{ editSelectedDocumentFile.name }}</div>
                    <div class="pdf-size">{{ formatFileSize(editSelectedDocumentFile.size) }}</div>
                    <button type="button" class="view-pdf-btn" (click)="openPdfPreview(editSelectedDocumentFile)">
                      ğŸ“– Ouvrir le PDF
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>

      <!-- Message si modification non autorisÃ©e -->
      <div class="modification-disabled-message" *ngIf="!canEditReclamation(reclamationToEdit)">
        <p>Cette rÃ©clamation ne peut plus Ãªtre modifiÃ©e car elle n'est plus en attente de traitement.</p>
      </div>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="btn-cancel" (click)="closeEditReclamationModal()">
        Annuler
      </button>
      <button 
        type="button" 
        class="btn-submit" 
        (click)="submitEditReclamation()"
        [disabled]="editReclamationForm.invalid || isEditingReclamation || !canEditReclamation(reclamationToEdit)"
        *ngIf="canEditReclamation(reclamationToEdit)"
      >
        <span *ngIf="isEditingReclamation">ğŸ”„ Modification...</span>
        <span *ngIf="!isEditingReclamation">âœï¸ Enregistrer les modifications</span>
      </button>
    </div>
  </div>
</div>

<!-- Modal pour afficher la liste des renseignements -->
<div class="modal-overlay" [class.show]="isRenseignementsListModalOpen" (click)="closeRenseignementsListModal()">
  <div class="modal-content renseignements-list-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">ğŸ’¬ Mes Renseignements</h3>
      <div class="header-actions">
        <button class="add-renseignement-btn-header" (click)="openRenseignement(); closeRenseignementsListModal()">
          <span class="btn-icon">ğŸ’¬</span>
          Nouveau renseignement
        </button>
        <button class="modal-close" (click)="closeRenseignementsListModal()">Ã—</button>
      </div>
    </div>
    
    <div class="modal-body">
      <!-- Filtres -->
      <div class="filters-section">
        <h4 class="filters-title">ğŸ” Filtres</h4>
        <div class="filters-row">
          <div class="filter-group">
            <label for="filterIdRens">ID renseignement :</label>
            <input 
              id="filterIdRens" 
              type="text" 
              [(ngModel)]="filterIdRens" 
              (input)="onRenseignementFilterChange()"
              placeholder="Rechercher par ID..."
              class="filter-input"
            >
          </div>
          
          <div class="filter-group">
            <label for="filterSujetRens">Sujet :</label>
            <select 
              id="filterSujetRens" 
              [(ngModel)]="filterSujetRens" 
              (change)="onRenseignementFilterChange()"
              class="filter-select"
            >
              <option value="">Tous les sujets</option>
              <option *ngFor="let option of sujetRenseignementOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </div>
          
          <div class="filter-actions">
            <button class="clear-filters-btn" (click)="clearRenseignementFilters()">
              ğŸ”„ Effacer
            </button>
          </div>
        </div>
      </div>
      
      <!-- Loading -->
      <div class="loading-section" *ngIf="isLoadingRenseignements">
        <div class="loading-spinner"></div>
        <p>Chargement des renseignements...</p>
      </div>
      
      <!-- Liste des renseignements -->
      <div class="renseignements-list" *ngIf="!isLoadingRenseignements">
        <div class="renseignements-header">
          <h4>
            ğŸ“Š {{ filteredRenseignementsList.length }} renseignement(s) 
            <span *ngIf="filteredRenseignementsList.length !== renseignementsList.length">
              sur {{ renseignementsList.length }}
            </span>
          </h4>
        </div>
        
        <!-- Message si aucun renseignement -->
        <div class="no-renseignements" *ngIf="filteredRenseignementsList.length === 0">
          <div class="no-data-icon">ğŸ’¬</div>
          <h5>Aucun renseignement trouvÃ©</h5>
          <p *ngIf="renseignementsList.length === 0">Vous n'avez pas encore crÃ©Ã© de renseignement.</p>
          <p *ngIf="renseignementsList.length > 0">Aucun renseignement ne correspond Ã  vos critÃ¨res de recherche.</p>
        </div>
        
        <!-- Cartes des renseignements -->
        <div class="renseignements-grid" *ngIf="filteredRenseignementsList.length > 0">
          <div class="renseignement-card" *ngFor="let renseignement of filteredRenseignementsList">
            <div class="renseignement-header">
              <div class="renseignement-id">
                <span class="id-label">ID:</span>
                <span class="id-value">#{{ renseignement.idRens }}</span>
              </div>
              <div class="renseignement-status" [class]="renseignement.descriptionReponRens ? 'status-resolved' : 'status-pending'">
                {{ renseignement.descriptionReponRens ? 'RÃ©pondu' : 'En attente' }}
              </div>
            </div>
            
            <div class="renseignement-body">
              <div class="renseignement-sujet">
                <span class="sujet-icon">ğŸ“‹</span>
                <span class="sujet-text">{{ renseignement.sujetRens }}</span>
              </div>
              
              <div class="renseignement-description">
                <h6>ğŸ’¬ Demande:</h6>
                <p>{{ renseignement.descriptionRens }}</p>
              </div>
              
              <div class="renseignement-dates">
                <div class="date-item">
                  <span class="date-label">ğŸ“… CrÃ©Ã© le:</span>
                  <span class="date-value">{{ formatRenseignementDate(renseignement.dateRens) }}</span>
                </div>
                <div class="date-item" *ngIf="renseignement.dateReponRens">
                  <span class="date-label">âœ… RÃ©pondu le:</span>
                  <span class="date-value">{{ formatRenseignementDate(renseignement.dateReponRens) }}</span>
                </div>
              </div>
              
              <!-- RÃ©ponse si disponible -->
              <div class="renseignement-response" *ngIf="renseignement.descriptionReponRens">
                <h6>ğŸ’¬ RÃ©ponse:</h6>
                <p>{{ renseignement.descriptionReponRens }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal pour donner un avis -->
<div class="modal-overlay" [class.show]="isAvisModalOpen" (click)="closeAvisModal()">
  <div class="modal-content avis-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">â­ Donner votre avis</h3>
      <button class="modal-close" (click)="closeAvisModal()">Ã—</button>
    </div>
    
    <div class="modal-body" *ngIf="currentReclamationForAvis">
      <!-- Informations sur la rÃ©clamation -->
      <div class="reclamation-info-section">
        <h4 class="info-title">ğŸ“‹ RÃ©clamation #{{ currentReclamationForAvis.idRecl }}</h4>
        <div class="reclamation-summary">
          <div class="summary-item">
            <span class="summary-label">Type:</span>
            <span class="summary-value">{{ getTypeReclLabel(currentReclamationForAvis.typeRecl) }}</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Ã‰tat:</span>
            <span class="summary-value status-badge status-resolved">{{ getEtatReclLabel(currentReclamationForAvis.etatRecl) }}</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Date de rÃ©solution:</span>
            <span class="summary-value">{{ formatDate(currentReclamationForAvis.dateReponRecl) }}</span>
          </div>
        </div>
      </div>

      <!-- Message d'information -->
      <div class="info-banner">
        <div class="info-icon">ğŸ’¡</div>
        <div class="info-content">
          <h5>Votre avis compte !</h5>
          <p>Aidez-nous Ã  amÃ©liorer notre service en Ã©valuant la qualitÃ© de traitement de votre rÃ©clamation.</p>
        </div>
      </div>

      <!-- Formulaire d'avis -->
      <form [formGroup]="avisForm" class="avis-form">
        <!-- Note avec Ã©toiles -->
        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">â­</span>
            Ã‰valuation gÃ©nÃ©rale *
          </label>
          <div class="star-rating-container">
            <div class="star-rating">
              <span 
                *ngFor="let star of [1,2,3,4,5]; let i = index"
                class="star"
                [class.filled]="i < getStarRating()"
                (click)="setStarRating(i + 1)"
                [title]="(i + 1) + ' Ã©toile(s)'"
              >
                â˜…
              </span>
            </div>
            <div class="rating-labels">
              <span class="rating-label" [class.active]="getStarRating() === 1">TrÃ¨s insatisfait</span>
              <span class="rating-label" [class.active]="getStarRating() === 2">Insatisfait</span>
              <span class="rating-label" [class.active]="getStarRating() === 3">Neutre</span>
              <span class="rating-label" [class.active]="getStarRating() === 4">Satisfait</span>
              <span class="rating-label" [class.active]="getStarRating() === 5">TrÃ¨s satisfait</span>
            </div>
          </div>
          <div class="error-message" *ngIf="avisForm.get('note')?.invalid && avisForm.get('note')?.touched">
            <span *ngIf="avisForm.get('note')?.errors?.['required']">Veuillez donner une note</span>
            <span *ngIf="avisForm.get('note')?.errors?.['min'] || avisForm.get('note')?.errors?.['max']">La note doit Ãªtre entre 1 et 5</span>
          </div>
        </div>

        <!-- Commentaire -->
        <div class="form-group">
          <label for="commentaireAvis" class="form-label">
            <span class="label-icon">ğŸ’¬</span>
            Votre commentaire *
          </label>
          <textarea 
            id="commentaireAvis"
            formControlName="commentaire"
            class="form-textarea"
            rows="4"
            placeholder="DÃ©crivez votre expÃ©rience, ce qui vous a satisfait ou ce qui pourrait Ãªtre amÃ©liorÃ©..."
            [class.error]="avisForm.get('commentaire')?.invalid && avisForm.get('commentaire')?.touched"
          ></textarea>
          <div class="char-counter">
            {{ avisForm.get('commentaire')?.value?.length || 0 }}/500 caractÃ¨res
          </div>
          <div class="error-message" *ngIf="avisForm.get('commentaire')?.invalid && avisForm.get('commentaire')?.touched">
            <span *ngIf="avisForm.get('commentaire')?.errors?.['required']">Le commentaire est requis</span>
            <span *ngIf="avisForm.get('commentaire')?.errors?.['minlength']">Le commentaire doit contenir au moins 10 caractÃ¨res</span>
            <span *ngIf="avisForm.get('commentaire')?.errors?.['maxlength']">Le commentaire ne peut pas dÃ©passer 500 caractÃ¨res</span>
          </div>
        </div>
      </form>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="btn-cancel" (click)="closeAvisModal()">
        Annuler
      </button>
      <button 
        type="button" 
        class="btn-submit" 
        (click)="submitAvis()"
        [disabled]="avisForm.invalid || isSubmittingAvis"
      >
        <span *ngIf="isSubmittingAvis">ğŸ”„ Envoi...</span>
        <span *ngIf="!isSubmittingAvis">â­ Envoyer l'avis</span>
      </button>
    </div>
  </div>
</div>
